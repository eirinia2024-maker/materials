<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Power English ‚Äî –≤–∏—Ç—Ä–∏–Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</title>
  <style>
    /*
      –î–ò–ó–ê–ô–ù: –≤–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω readwithowly.ru ‚Äî —Å–≤–µ—Ç–ª—ã–π, —á–∏—Å—Ç—ã–π, —Å –º—è–≥–∫–∏–º–∏ –∫–∞—Ä—Ç–æ—á–∫–∞–º–∏ –∏ –±–æ–ª—å—à–∏–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏.
      (–ù–µ –∫–æ–ø–∏—Ä—É–µ–º –∫–æ–¥/—Å—Ç–∏–ª–∏ —Å–∞–π—Ç–∞ 1:1 ‚Äî –¥–µ–ª–∞–µ–º –ø–æ—Ö–æ–∂–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.)
    */

    :root{
      --bg: #f6f7fb;
      --paper: #ffffff;
      --text: #0f172a;
      --muted: #475569;
      --line: rgba(15,23,42,.10);
      --shadow: 0 10px 30px rgba(15,23,42,.10);
      --shadow2: 0 18px 60px rgba(15,23,42,.16);
      --radius: 18px;

      /* ‚úÖ –ë–æ–ª—å—à–µ —Ü–≤–µ—Ç–∞, –Ω–æ –≤ —Ç–æ–º –∂–µ "—á–∏—Å—Ç–æ–º" —Å—Ç–∏–ª–µ */
      --accent: #ef4444;    /* –∫—Ä–∞—Å–Ω—ã–π */
      --accent2: #2563eb;   /* —Å–∏–Ω–∏–π */
      --mint: #10b981;      /* –º—è—Ç–Ω—ã–π */
      --sun: #f59e0b;       /* —Ç—ë–ø–ª—ã–π –∂—ë–ª—Ç—ã–π */

      --softBlue: rgba(37,99,235,.12);
      --softRed:  rgba(239,68,68,.10);
      --softMint: rgba(16,185,129,.10);
      --softSun:  rgba(245,158,11,.10);
    }

    *{ box-sizing:border-box; }
    html,body{
      margin:0;
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      /* ‚úÖ –ß—É—Ç—å –±–æ–ª–µ–µ "–∂–∏–≤–æ–π" —Ñ–æ–Ω, –Ω–æ –≤—Å—ë –µ—â—ë –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π */
      background:
        radial-gradient(1200px 700px at 12% -10%, var(--softBlue), transparent 60%),
        radial-gradient(1000px 600px at 92% 0%, var(--softRed), transparent 62%),
        radial-gradient(900px 700px at 55% 110%, var(--softMint), transparent 60%),
        linear-gradient(180deg, #f7f8ff 0%, #f6f7fb 55%, #f4f7ff 100%);
    }

    a{ color:inherit; text-decoration:none; }

    .wrap{
      max-width: 1120px;
      margin: 0 auto;
      padding: 18px 18px 72px;
    }

    /* =========================
       TOP NAV
       ========================= */
    .topbar{
      position: sticky;
      top: 0;
      z-index: 50;
      background: rgba(246,247,251,.72);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(15,23,42,.06);
    }

    .topbar-inner{
      max-width: 1120px;
      margin: 0 auto;
      padding: 12px 18px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 14px;
      flex-wrap: wrap;
    }

    .brand{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 220px;
    }

    /* –õ–æ–≥–æ-–ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä: –º–æ–∂–µ—à—å –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, owly) */
    .logo{
      width: 38px;
      height: 38px;
      border-radius: 12px;
      background: linear-gradient(135deg, rgba(37,99,235,.18), rgba(239,68,68,.14));
      border: 1px solid rgba(15,23,42,.08);
      display:grid;
      place-items:center;
      font-weight: 800;
      color: rgba(15,23,42,.75);
      user-select:none;
    }

    .brand-title{
      display:flex;
      flex-direction:column;
      gap: 2px;
      line-height: 1.1;
    }

    .brand-title b{ font-size: 14px; letter-spacing: .2px; }
    .brand-title span{ font-size: 12px; color: var(--muted); }

    .actions{
      display:flex;
      gap: 10px;
      align-items:center;
      flex-wrap: wrap;
    }

    .search{
      display:flex;
      align-items:center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 999px;
      background: var(--paper);
      border: 1px solid rgba(15,23,42,.10);
      box-shadow: 0 8px 20px rgba(15,23,42,.06);
    }

    .search input{
      width: min(360px, 56vw);
      border: none;
      outline: none;
      font-size: 14px;
      background: transparent;
      color: var(--text);
    }

    .btn{
      border: 1px solid rgba(15,23,42,.12);
      background: var(--paper);
      color: var(--text);
      padding: 8px 10px; /* ‚Üê ~30% –º–µ–Ω—å—à–µ */
      border-radius: 14px;
      cursor:pointer;
      transition: transform .08s ease, box-shadow .15s ease, border-color .15s ease;
      box-shadow: 0 10px 24px rgba(15,23,42,.06);
      user-select:none;
      white-space: nowrap;
      font-weight: 600;
      font-size: 14px;
    }
    .btn:hover{ border-color: rgba(37,99,235,.35); box-shadow: 0 12px 26px rgba(15,23,42,.10); }
    .btn:active{ transform: translateY(1px); }

    .btn.primary{
      border-color: rgba(37,99,235,.28);
      background: linear-gradient(180deg, rgba(37,99,235,.14), rgba(255,255,255,1));
    }

    /* –õ—ë–≥–∫–∞—è —Ü–≤–µ—Ç–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ (–µ—Å–ª–∏ —Ö–æ—á–µ—à—å —Å–∏–ª—å–Ω–µ–µ –∞–∫—Ü–µ–Ω—Ç ‚Äî –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —è—Ä—á–µ) */
    a.btn.primary{ color: rgba(15,23,42,.95); }

    /* =========================
       HERO
       ========================= */
    .hero{
      margin-top: 18px;
      background:
        linear-gradient(180deg, rgba(255,255,255,1), rgba(255,255,255,.92)),
        radial-gradient(700px 260px at 12% 20%, var(--softBlue), transparent 65%),
        radial-gradient(620px 260px at 88% 10%, var(--softRed), transparent 65%),
        radial-gradient(560px 260px at 60% 120%, var(--softMint), transparent 65%);
      border: 1px solid rgba(15,23,42,.08);
      border-radius: 24px;
      box-shadow: var(--shadow);
      padding: 26px;
      display:block;
      overflow:hidden;
      position: relative;
    }
    .hero:before{
      content:"";
      position:absolute;
      inset:-1px;
      background:
        radial-gradient(500px 240px at 15% 10%, rgba(37,99,235,.10), transparent 60%),
        radial-gradient(500px 260px at 90% 0%, rgba(239,68,68,.10), transparent 60%);
      pointer-events:none;
    }
    .hero > *{ position:relative; }

    .hero h1{
      margin:0;
      font-size: clamp(26px, 3.2vw, 36px);
      line-height: 1.05;
      letter-spacing: -0.2px;
    }
    .hero p{
      margin: 10px 0 0;
      color: var(--muted);
      line-height: 1.55;
      font-size: 14.5px;
      max-width: 62ch;
    }
    .hero-badges{
      margin-top: 14px;
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items:center;
    }
    .badge{
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(15,23,42,.10);
      background: rgba(37,99,235,.06);
      font-size: 12.5px;
      color: rgba(15,23,42,.85);
      font-weight: 600;
    }

    /* ‚úÖ –ö–Ω–æ–ø–∫–∏-—Ñ–∏–ª—å—Ç—Ä—ã (chips) */
    .chip{
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(15,23,42,.10);
      background: rgba(255,255,255,.92);
      font-size: 12.5px;
      color: rgba(15,23,42,.88);
      font-weight: 750;
      cursor: pointer;
      box-shadow: 0 10px 24px rgba(15,23,42,.06);
      transition: transform .08s ease, border-color .15s ease, background .15s ease;
      user-select:none;
    }
    .chip:hover{ border-color: rgba(37,99,235,.35); }
    .chip:active{ transform: translateY(1px); }
    .chip.active{
      border-color: rgba(37,99,235,.35);
      background:
        linear-gradient(180deg, rgba(37,99,235,.14), rgba(255,255,255,1));
    }

    /* ‚úÖ –ª—ë–≥–∫–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –ø–æ —Ç–∏–ø—É —Ñ–∏–ª—å—Ç—Ä–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –∫—Ä–∞—Å–∏–≤–æ) */
    .chip[data-filter="grammar"].active{ border-color: rgba(239,68,68,.35); background: linear-gradient(180deg, rgba(239,68,68,.14), rgba(255,255,255,1)); }
    .chip[data-filter="reading"].active{ border-color: rgba(16,185,129,.35); background: linear-gradient(180deg, rgba(16,185,129,.14), rgba(255,255,255,1)); }
    .chip[data-filter="thematic"].active{ border-color: rgba(245,158,11,.35); background: linear-gradient(180deg, rgba(245,158,11,.14), rgba(255,255,255,1)); }
    .chip[data-filter="other"].active{ border-color: rgba(37,99,235,.35); background: linear-gradient(180deg, rgba(37,99,235,.14), rgba(255,255,255,1)); }

    /* =========================
       LUCKY BUTTON (gamification)
       ========================= */
    .luck-btn{
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(37,99,235,.28);
      background:
        radial-gradient(140px 60px at 18% 15%, rgba(245,158,11,.22), transparent 62%),
        radial-gradient(160px 70px at 86% 15%, rgba(239,68,68,.18), transparent 64%),
        linear-gradient(180deg, rgba(37,99,235,.14), rgba(255,255,255,1));
      font-size: 12.5px;
      color: rgba(15,23,42,.92);
      font-weight: 850;
      cursor: pointer;
      box-shadow: 0 12px 28px rgba(15,23,42,.10);
      transition: transform .08s ease, box-shadow .15s ease, border-color .15s ease;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      white-space: nowrap;
    }
    .luck-btn:hover{ border-color: rgba(239,68,68,.35); box-shadow: 0 14px 34px rgba(15,23,42,.12); }
    .luck-btn:active{ transform: translateY(1px); }
    .luck-btn[disabled]{
      opacity: .7;
      cursor: not-allowed;
      transform: none;
    }
    .luck-spark{
      width: 18px;
      height: 18px;
      border-radius: 8px;
      display:grid;
      place-items:center;
      background: rgba(239,68,68,.10);
      border: 1px solid rgba(15,23,42,.10);
    }

    .hero-card{
      border-radius: 18px;
      border: 1px solid rgba(15,23,42,.10);
      background: linear-gradient(180deg, rgba(255,255,255,1), rgba(37,99,235,.04));
      padding: 16px;
      display:flex;
      flex-direction: column;
      gap: 10px;
      box-shadow: 0 12px 30px rgba(15,23,42,.08);
      align-self: start;
    }
    .hero-card b{ font-size: 13px; }
    .hero-card small{ color: var(--muted); line-height: 1.45; }

    @media (max-width: 860px){
      .hero{ grid-template-columns: 1fr; }
    }

    /* =========================
       SECTION HEADER
       ========================= */
    .section-head{
      margin-top: 22px;
      display:flex;
      align-items:flex-end;
      justify-content: space-between;
      gap: 14px;
      flex-wrap: wrap;
    }
    .section-head h2{
      margin:0;
      font-size: 18px;
      letter-spacing: .1px;
    }
    .section-head p{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
      max-width: 70ch;
    }

    /* =========================
       GRID CARDS
       ========================= */
    .grid{
      margin-top: 14px;
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 14px;
    }

    .card{
      grid-column: span 3; /* 4 –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ —Ä—è–¥ */
      background:
        linear-gradient(180deg, rgba(255,255,255,1), rgba(37,99,235,.03));
      border: 1px solid rgba(15,23,42,.10);
      border-radius: var(--radius);
      box-shadow: 0 14px 32px rgba(15,23,42,.08);
      overflow:hidden;
      display:flex;
      flex-direction: column;
      min-height: 224px;
      position: relative;
    }

    /* —Ç–æ–Ω–∫–∞—è —Ü–≤–µ—Ç–Ω–∞—è –ø–æ–ª–æ—Å–∫–∞ —Å–≤–µ—Ä—Ö—É –∫–∞—Ä—Ç–æ—á–∫–∏ (–∫–∞–∫ –∞–∫—Ü–µ–Ω—Ç) */
    .card::before{
      content:"";
      position:absolute;
      left:0; right:0; top:0;
      height: 4px;
      background: linear-gradient(90deg, rgba(37,99,235,.9), rgba(239,68,68,.85), rgba(16,185,129,.85), rgba(245,158,11,.9));
      opacity: .55;
    }

    @media (max-width: 980px){
      .card{ grid-column: span 6; }
    }
    @media (max-width: 620px){
      .card{ grid-column: span 12; }
      .search input{ width: 46vw; }
    }

    /* ‚úÖ –ö–≤–∞–¥—Ä–∞—Ç–Ω–∞—è –æ–±–ª–æ–∂–∫–∞ –±–µ–∑ –æ–±—Ä–µ–∑–∫–∏ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫) */
    .thumb{
      cursor: pointer;
      border: none;
      width: 100%;
      text-align: left;
      font: inherit;
      background: none;
      display:flex;
      align-items:center;
      justify-content:center;

      /* ‚úÖ –±–æ–ª–µ–µ —Ü–≤–µ—Ç–Ω–∞—è, –Ω–æ –º—è–≥–∫–∞—è –ø–æ–¥–ª–æ–∂–∫–∞ */
      aspect-ratio: 1 / 1;
      background:
        radial-gradient(220px 160px at 18% 18%, var(--softBlue), transparent 65%),
        radial-gradient(220px 160px at 82% 22%, var(--softRed), transparent 65%),
        radial-gradient(240px 180px at 60% 90%, var(--softMint), transparent 65%),
        linear-gradient(180deg, rgba(37,99,235,.06), rgba(239,68,68,.04));
      border-bottom: 1px solid rgba(15,23,42,.08);
      padding: 7px;
    }

    .thumb img{
      pointer-events: none; /* —á—Ç–æ–±—ã –∫–ª–∏–∫ –≤—Å–µ–≥–¥–∞ –ø–æ–ø–∞–¥–∞–ª –≤ –∫–Ω–æ–ø–∫—É-–æ–±–ª–æ–∂–∫—É */
      width: 100%;
      height: 100%;
      object-fit: contain;
      display:block;
      border-radius: 12px;
      background: rgba(255,255,255,.75);
      border: 1px solid rgba(15,23,42,.08);
    }

    .card-body{
      padding: 10px 10px 9px; /* ‚Üê ~30% –º–µ–Ω—å—à–µ */
      display:flex;
      flex-direction: column;
      gap: 7px; /* ‚Üê ~30% –º–µ–Ω—å—à–µ */
      flex:1;
    }

    .title{
      margin:0;
      font-size: 14px; /* ‚Üê ~30% –º–µ–Ω—å—à–µ */
      line-height: 1.25;
      letter-spacing: .1px;
    }

    .desc{
      margin:0;
      color: var(--muted);
      font-size: 12px; /* ‚Üê ~30% –º–µ–Ω—å—à–µ */
      line-height: 1.45;
      flex:1;
    }

    .row{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 4px;
    }

    .pill{
      font-size: 12px;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(15,23,42,.10);
      background: rgba(37,99,235,.08);
      color: rgba(15,23,42,.85);
      font-weight: 800;
      white-space: nowrap;
    }

    .price{
      font-weight: 800;
      color: rgba(15,23,42,.88);
      font-size: 13px;
    }

    .card-actions{
      display:flex;
      gap: 10px;
      margin-top: 10px;
    }

    /* =========================
       MODAL
       ========================= */
    .overlay{
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,.55);
      backdrop-filter: blur(8px);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 100;
    }

    .modal{
      width: min(980px, 100%);
      background: var(--paper);
      border-radius: 22px;
      border: 1px solid rgba(15,23,42,.12);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }

    .modal-top{
      display:flex;
      align-items:center;
      justify-content: space-between;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(15,23,42,.08);
      background: linear-gradient(180deg, rgba(37,99,235,.05), rgba(255,255,255,1));
    }

    .modal-top b{ font-size: 14px; }

    .xbtn{
      width: 40px;
      height: 40px;
      border-radius: 14px;
      border: 1px solid rgba(15,23,42,.12);
      background: #fff;
      cursor:pointer;
      font-size: 18px;
      display:grid;
      place-items:center;
      box-shadow: 0 10px 24px rgba(15,23,42,.06);
    }

    .modal-content{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
    }

    @media (max-width: 880px){
      .modal-content{ grid-template-columns: 1fr; }
    }

    /* Carousel */
    .carousel{
      position: relative;
      background: linear-gradient(180deg, rgba(37,99,235,.07), rgba(239,68,68,.05));
      border-right: 1px solid rgba(15,23,42,.08);
      min-height: 360px;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 16px;
    }

    .carousel img{
      /* ‚úÖ –ü—Ä–µ–≤—å—é –∫–∞–∫ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ A4 (–ø–æ—Ä—Ç—Ä–µ—Ç): —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ 1 : 1.414 */
      width: min(420px, 100%);
      aspect-ratio: 1 / 1.4142;
      height: auto;
      max-height: 70vh;
      object-fit: contain;
      border-radius: 16px;
      background: rgba(255,255,255,.8);
      border: 1px solid rgba(15,23,42,.10);
      display:block;
    }

    .nav{
      position:absolute;
      top:50%;
      transform: translateY(-50%);
      width: 44px;
      height: 44px;
      border-radius: 14px;
      border: 1px solid rgba(15,23,42,.12);
      background: rgba(255,255,255,.92);
      cursor:pointer;
      display:grid;
      place-items:center;
      box-shadow: 0 10px 24px rgba(15,23,42,.08);
      user-select:none;
      font-size: 18px;
    }

    .nav.left{ left: 16px; }
    .nav.right{ right: 16px; }

    .dots{
      position:absolute;
      left:0; right:0; bottom: 14px;
      display:flex;
      justify-content:center;
      gap: 8px;
      padding: 0 12px;
    }

    .dot{
      width: 9px;
      height: 9px;
      border-radius: 999px;
      border: 1px solid rgba(15,23,42,.18);
      background: rgba(15,23,42,.10);
      cursor:pointer;
    }

    .dot.active{
      background: rgba(239,68,68,.55);
      border-color: rgba(239,68,68,.55);
    }

    .info{
      padding: 16px;
      display:flex;
      flex-direction: column;
      gap: 10px;
    }

    .info h3{
      margin:0;
      font-size: 20px;
      letter-spacing: -.1px;
      line-height: 1.2;
    }

    .info p{
      margin:0;
      color: var(--muted);
      line-height: 1.55;
      font-size: 14px;
      white-space: pre-line;
    }

    .buybar{
      margin-top:auto;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
      padding-top: 12px;
      border-top: 1px solid rgba(15,23,42,.08);
    }

    .muted{
      font-size: 12.5px;
      color: var(--muted);
      line-height: 1.4;
    }

    footer{
      margin-top: 26px;
      color: var(--muted);
      font-size: 12.5px;
      line-height: 1.5;
    }

    footer a{ color: var(--accent2); text-decoration: underline; }

    /* =========================
       LUCKY GAME MODAL
       ========================= */
    .luck-modal{
      width: min(860px, 100%);
      background: var(--paper);
      border-radius: 22px;
      border: 1px solid rgba(15,23,42,.12);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }

    .luck-head{
      display:flex;
      align-items:center;
      justify-content: space-between;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(15,23,42,.08);
      background:
        radial-gradient(520px 180px at 15% 30%, rgba(37,99,235,.10), transparent 62%),
        radial-gradient(520px 180px at 90% 20%, rgba(239,68,68,.10), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,1), rgba(255,255,255,.92));
    }

    .luck-head b{
      font-size: 14px;
      letter-spacing: .1px;
      display:flex;
      align-items:center;
      gap: 10px;
    }

    .luck-body{
      padding: 16px;
      display:flex;
      flex-direction: column;
      gap: 12px;
    }

    .luck-sub{
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }

    .luck-board{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    @media (max-width: 720px){
      .luck-board{ grid-template-columns: repeat(2, 1fr); }
    }

    .pcard{
      position: relative;
      border-radius: 18px;
      border: 1px solid rgba(15,23,42,.10);
      background: rgba(255,255,255,.92);
      box-shadow: 0 14px 32px rgba(15,23,42,.08);
      min-height: 110px;
      cursor: pointer;
      user-select:none;
      perspective: 900px;
      overflow:hidden;
    }
    .pcard[aria-disabled="true"]{ cursor: default; }

    .pinner{
      position:absolute;
      inset:0;
      transform-style: preserve-3d;
      transition: transform 520ms cubic-bezier(.2,.85,.2,1);
    }

    .pface{
      position:absolute;
      inset:0;
      backface-visibility: hidden;
      display:flex;
      flex-direction: column;
      justify-content: center;
      padding: 14px 14px 13px;
      gap: 8px;
    }

    .pfront{
      background:
        radial-gradient(240px 120px at 18% 15%, rgba(37,99,235,.12), transparent 62%),
        radial-gradient(240px 120px at 86% 10%, rgba(239,68,68,.10), transparent 64%),
        radial-gradient(260px 140px at 60% 120%, rgba(16,185,129,.10), transparent 64%),
        linear-gradient(180deg, rgba(255,255,255,1), rgba(37,99,235,.04));
    }

    .pfront .ptitle{
      font-weight: 900;
      font-size: 13px;
      line-height: 1.2;
    }
    .pfront .pmeta{
      color: var(--muted);
      font-size: 12px;
      line-height: 1.35;
    }

    .pback{
      transform: rotateY(180deg);
      background:
        radial-gradient(220px 120px at 20% 20%, rgba(245,158,11,.14), transparent 62%),
        radial-gradient(240px 140px at 80% 20%, rgba(37,99,235,.12), transparent 64%),
        linear-gradient(180deg, rgba(255,255,255,1), rgba(239,68,68,.04));
    }

    .pseal{
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 10px;
      font-weight: 950;
      letter-spacing: .2px;
      color: rgba(15,23,42,.85);
      font-size: 13px;
    }

    .pseal .dot{
      width: 10px;
      height: 10px;
      border-radius: 999px;
      border: 1px solid rgba(15,23,42,.18);
      background: rgba(239,68,68,.35);
    }

    .pinner.face-down{ transform: rotateY(180deg); }
    .pinner.revealed{ transform: rotateY(0deg); }

    /* Shuffle animation (visual only) */
    .pcard.shuffling{ animation: pshake 820ms ease-in-out infinite; }
    @keyframes pshake{
      0%{ transform: translateY(0) rotate(0deg); }
      25%{ transform: translateY(-1px) rotate(-.4deg); }
      50%{ transform: translateY(0) rotate(.5deg); }
      75%{ transform: translateY(1px) rotate(-.3deg); }
      100%{ transform: translateY(0) rotate(0deg); }
    }

    .luck-controls{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
      padding-top: 6px;
    }

    .luck-controls .left{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .linkbtn{
      border: none;
      background: none;
      color: var(--accent2);
      font-weight: 700;
      cursor: pointer;
      padding: 6px 4px;
      text-decoration: underline;
      font-size: 12.5px;
    }

    .luck-note{
      font-size: 12.5px;
      color: var(--muted);
      line-height: 1.4;
    }

    .mini-overlay{
      position: fixed;
      inset: 0;
      background: rgba(15,23,42,.55);
      backdrop-filter: blur(8px);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index: 120;
    }
    .mini{
      width: min(720px, 100%);
      background: var(--paper);
      border-radius: 22px;
      border: 1px solid rgba(15,23,42,.12);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .mini .mini-top{
      display:flex;
      align-items:center;
      justify-content: space-between;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(15,23,42,.08);
      background: linear-gradient(180deg, rgba(37,99,235,.05), rgba(255,255,255,1));
    }
    .mini .mini-body{ padding: 16px; }
    .mini .mini-body p{
      margin: 0 0 10px;
      color: var(--muted);
      line-height: 1.55;
      font-size: 13.5px;
    }

  </style>
</head>
<body>

  <!-- TOP NAV -->
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <!-- ‚úÖ –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ª–æ–≥–æ—Ç–∏–ø-—Å–æ–≤—ë–Ω–∫–∞: –ø–æ–ª–æ–∂–∏ —Ñ–∞–π–ª –≤ img/logo.png –∏ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π img –Ω–∏–∂–µ -->
        <!-- <img src="img/logo.png" alt="Power English" style="width:38px;height:38px;border-radius:12px;object-fit:cover;border:1px solid rgba(15,23,42,.10)"> -->
        <div class="logo">PE</div>
        <div class="brand-title">
          <b>Power English</b>
          <span>–≤–∏—Ç—Ä–∏–Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</span>
        </div>
      </div>

      <div class="actions">
        <div class="search" title="–ü–æ–∏—Å–∫ –ø–æ —Ç–æ–≤–∞—Ä–∞–º">
          üîé <input id="q" type="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–æ–≤–∞—Ä–∞–º‚Ä¶" />
        </div>
        <a class="btn" href="https://edberries.store/power-english/" target="_blank" rel="noopener">Edberries</a>
        <a class="btn primary" href="https://vk.ru/eirinia" target="_blank" rel="noopener">–ö—É–ø–∏—Ç—å –≤ VK</a>
      </div>
    </div>
  </div>

  <div class="wrap">

    <!-- HERO -->
    <section class="hero">
      <div>
        <h1>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ ‚Äî
          <span style="color:var(--accent2)">–≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ</span>
        </h1>

        <div class="hero-badges" aria-label="–§–∏–ª—å—Ç—Ä—ã –∫–∞—Ç–∞–ª–æ–≥–∞">
          <!-- ‚úÖ –§–ò–õ–¨–¢–†–´: –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.
               –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ ‚Äî –≤–Ω–∏–∑—É –≤ JS.
               –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞–¥–∞—ë—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤–µ PRODUCTS –ø–æ–ª–µ–º category. -->
          <button class="chip active" type="button" data-filter="all">–í—Å–µ</button>
          <button class="chip" type="button" data-filter="grammar">–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞</button>
          <button class="chip" type="button" data-filter="reading">–ß—Ç–µ–Ω–∏–µ</button>
          <button class="chip" type="button" data-filter="thematic">–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É—Ä–æ–∫–∏</button>
          <button class="chip" type="button" data-filter="other">–î—Ä—É–≥–æ–µ</button>

          <!-- üé≤ –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è: –∫–Ω–æ–ø–∫–∞ –º–∏–Ω–∏-–∏–≥—Ä—ã (–∫–∞–∫ –Ω–∞ —Ç–≤–æ—ë–º —Å–∫—Ä–∏–Ω–µ) -->
          <button id="luckBtn" class="luck-btn" type="button" style="margin-left:10px">
            <span class="luck-spark">üé≤</span>
            –ú–Ω–µ –ø–æ–≤–µ–∑—ë—Ç!
          </button>
        </div>
      </div>
    </section>

    <!-- SECTION HEAD -->
    
      </div>
    </div>

    <!-- GRID -->
    <section id="grid" class="grid" aria-label="–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤"></section>

    <!-- (–§—É—Ç–µ—Ä —É–±—Ä–∞–Ω –ø–æ –≤–∞—à–µ–π –ø—Ä–æ—Å—å–±–µ) -->


  </div>

  <!-- MODAL -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="modal-top">
        <b>–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏</b>
        <button id="close" class="xbtn" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
      </div>

      <div class="modal-content">
        <div class="carousel">
          <button id="prev" class="nav left" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ">‚Äπ</button>
          <img id="bigImg" alt="" />
          <button id="next" class="nav right" aria-label="–°–ª–µ–¥—É—é—â–µ–µ">‚Ä∫</button>
          <div id="dots" class="dots"></div>
        </div>

        <div class="info">
          <h3 id="mTitle">–ù–∞–∑–≤–∞–Ω–∏–µ</h3>
          <p id="mDesc">–û–ø–∏—Å–∞–Ω–∏–µ</p>

          <div class="buybar">
            <div>
              <!-- –¶–µ–Ω–∞ —Ç–µ–ø–µ—Ä—å –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ (–ø–æ —Ç–≤–æ–µ–π –ø—Ä–æ—Å—å–±–µ). –ú–æ–∂–µ—à—å –≤–µ—Ä–Ω—É—Ç—å —Ü–µ–Ω—É, –µ—Å–ª–∏ –Ω–∞–¥–æ. -->
              <div class="price" id="mPrice">–¶–µ–Ω–∞: —É—Ç–æ—á–Ω–∏—Ç—å</div>
              <div class="muted">–ù–∞–∂–º–∏—Ç–µ ¬´–ö—É–ø–∏—Ç—å¬ª, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –≤ VK.</div>
            </div>

            <a id="buy" class="btn primary" href="https://vk.ru/eirinia" target="_blank" rel="noopener">–ö—É–ø–∏—Ç—å</a>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- LUCKY GAME MODAL -->
  <div id="luckOverlay" class="overlay" aria-hidden="true">
    <div class="luck-modal" role="dialog" aria-modal="true" aria-label="–ú–∏–Ω–∏-–∏–≥—Ä–∞ —Å –ø—Ä–∏–∑–∞–º–∏">
      <div class="luck-head">
        <b>
          <span class="luck-spark">üéÅ</span>
          –ú–Ω–µ –ø–æ–≤–µ–∑—ë—Ç!
        </b>
        <button id="luckClose" class="xbtn" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
      </div>

      <div class="luck-body">
        <p id="luckSub" class="luck-sub">–ù–∞–∂–º–∏ ¬´–ò–≥—Ä–∞—Ç—å¬ª, –∑–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏ –æ–¥–Ω—É –∫–∞—Ä—Ç–æ—á–∫—É –∏ –ø–æ–ª—É—á–∏ –ø—Ä–∏–∑–æ–≤–æ–π –∫—É–ø–æ–Ω.</p>

        <div id="luckBoard" class="luck-board" aria-label="–ö–∞—Ä—Ç–æ—á–∫–∏ —Å –ø—Ä–∏–∑–∞–º–∏"></div>

        <div class="luck-controls">
          <div class="left">
            <button id="luckPlay" class="btn primary" type="button">–ò–≥—Ä–∞—Ç—å</button>
            <button id="luckDownload" class="btn" type="button" style="display:none">–°–∫–∞—á–∞—Ç—å –ø—Ä–∏–∑–æ–≤–æ–π –∫—É–ø–æ–Ω</button>
          </div>

          <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
            <button id="rulesBtn" class="linkbtn" type="button">–ü—Ä–∞–≤–∏–ª–∞ –∞–∫—Ü–∏–∏</button>
            <span id="luckStatus" class="luck-note"></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- RULES (mini modal) -->
  <div id="rulesOverlay" class="mini-overlay" aria-hidden="true">
    <div class="mini" role="dialog" aria-modal="true" aria-label="–ü—Ä–∞–≤–∏–ª–∞ –∞–∫—Ü–∏–∏">
      <div class="mini-top">
        <b>–ü—Ä–∞–≤–∏–ª–∞ –∞–∫—Ü–∏–∏</b>
        <button id="rulesClose" class="xbtn" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
      </div>
      <div class="mini-body">
        <p>–ü—Ä–∏–∑–æ–≤–æ–π –∫—É–ø–æ–Ω –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑.</p>
        <p><b>*</b> –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–≤–∞—Ä –ø–æ –Ω–∞–∏–º–µ–Ω—å—à–µ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤ –∫–æ—Ä–∑–∏–Ω–µ.</p>
        <p><b>**</b> –õ—é–±–∞—è –∫–Ω–∏–≥–∞ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ ¬´–ß—Ç–µ–Ω–∏–µ¬ª. –ü—Ä–∏–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∞–π—Ç–µ.</p>
        <p><b>***</b> –õ—é–±–æ–π –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç–µ–º–µ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ ¬´–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞¬ª. –ü—Ä–∏–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∞–π—Ç–µ.</p>
      </div>
    </div>
  </div>

  <script>
    /*
      –î–ê–ù–ù–´–ï –¢–û–í–ê–†–û–í
      ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      ‚úÖ –ú—ã –±–µ—Ä—ë–º —Å Edberries —Ç–æ–ª—å–∫–æ –ù–ê–ó–í–ê–ù–ò–ï –∏ –û–ü–ò–°–ê–ù–ò–ï.
      ‚úÖ –ö–∞—Ä—Ç–∏–Ω–∫–∏ ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ: —É–∫–∞–∂–∏ –ø—É—Ç–∏ —Ç–∏–ø–∞ "img/....jpg".

      –ö–∞–∫ —É–¥–æ–±–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:
      1) –ü–æ–ª–æ–∂–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ –ø–∞–ø–∫—É img —Ä—è–¥–æ–º —Å —ç—Ç–∏–º —Ñ–∞–π–ª–æ–º.
      2) –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞–ø–∏—à–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–æ–∫ –≤ images: ["img/xxx-1.jpg", "img/xxx-2.jpg"]
      3) –í –∫–∞—Ä—Ç–æ—á–∫–µ –±—É–¥–µ—Ç –ø–µ—Ä–≤–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞, –∞ –≤ –º–æ–¥–∞–ª–∫–µ ‚Äî –∫–∞—Ä—É—Å–µ–ª—å.

      –ò—Å—Ç–æ—á–Ω–∏–∫ —Ç–µ–∫—Å—Ç–æ–≤: edberries.store/power-english ([edberries.store](https://edberries.store/power-english/?currency=EUR&items_per_page=64&layout=products_without_options&sort_by=product&sort_order=asc&ysclid=123%C2%A4cy%3DRUB%C2%A4cy%3DEUR%C2%A4cy%3DEUR%C2%A4cy%3DRUB%C2%A4cy%3DEUR&utm_source=chatgpt.com))
    */

    const VK_BUY_URL = "https://vk.ru/eirinia";

    const PRODUCTS = [
      // ‚úÖ category: –æ–¥–Ω–∞ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ñ–∏–ª—å—Ç—Ä–∞
      // "grammar" | "reading" | "thematic" | "other"
      {
        title: "–ö–Ω–∏–≥–∞ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ A rainy day",
        category: "reading",
        short: "–ö–Ω–∏–≥–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ —Å –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–æ–π. –í —É—Ä–æ–∫ –≤—Å—Ç—Ä–æ–µ–Ω–æ –∞—É–¥–∏–æ. –¢–µ–º—ã: –ø–æ–≥–æ–¥–∞ –∏ —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è. Present Simple.",
        full: "–ö–Ω–∏–≥–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ —Å –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–æ–π. A rainy day –∏–∑ —Å–µ—Ä–∏–∏ Read and Imagine. –í —É—Ä–æ–∫ –≤—Å—Ç—Ä–æ–µ–Ω–æ –∞—É–¥–∏–æ. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤–≤–µ–¥–µ–Ω–∏—è —Ç–µ–º \"–ü–æ–≥–æ–¥–∞\" –∏ \"–°–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è\". –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —É—á–∞—â–∏—Ö—Å—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è. –¢–µ–∫—Å—Ç –Ω–∞–ø–∏—Å–∞–Ω –≤ Present Simple.",
        images: [
          "img/a-rainy-day-1.jpg",
          "img/a-rainy-day-2.jpg"
        ]
      },
      {
        title: "–ù–∞–±–æ—Ä —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π - A/An - article (Little Genius A)",
        category: "grammar",
        short: "\"–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∞—Ä—Ç–∏–∫–ª—å A/An\" –≤ —Ñ–æ—Ä–º–∞—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –í–∑–Ω–∞–Ω–∏—è.",
        full: "\"–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –∞—Ä—Ç–∏–∫–ª—å A/An\" –≤ —Ñ–æ—Ä–º–∞—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –í–∑–Ω–∞–Ω–∏—è.",
        images: [
          "img/a-an-article-1.jpg",
          "img/a-an-article-2.jpg"
        ]
      },
      {
        title: "–ù–∞–±–æ—Ä —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π - Articles (Grammar for schools 1)",
        category: "grammar",
        short: "Unit 3 Articles –∏–∑ Oxford Grammar for Schools 1.",
        full: "Unit 3 Articles –∏–∑ Oxford Grammar for Schools 1.",
        images: [
          "img/articles-grammar-for-schools-1-1.jpg"
        ]
      },
      {
        title: "–ö–Ω–∏–≥–∞ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ At the zoo",
        category: "reading",
        short: "–ö–Ω–∏–≥–∞ –¥–ª—è —É—á–∞—â–∏—Ö—Å—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è. –¢–µ–∫—Å—Ç—ã, –∞—É–¥–∏–æ –∏ –∑–∞–¥–∞–Ω–∏—è. –¢–µ–º–∞: –∂–∏–≤–æ—Ç–Ω—ã–µ –∏ —á—Ç–æ –æ–Ω–∏ –µ–¥—è—Ç.",
        full: "–ö–Ω–∏–≥–∞ –¥–ª—è —É—á–∞—â–∏—Ö—Å—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è - At the zoo. –í —É—Ä–æ–∫–µ: —Ç–µ–∫—Å—Ç—ã, –∞—É–¥–∏–æ –∏ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ –ª–µ–∫—Å–∏–∫–∏ –∏ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏. –ü–æ–¥–æ–π–¥—ë—Ç –¥–ª—è –≤–≤–µ–¥–µ–Ω–∏—è –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —Ç–µ–º—ã \"–ñ–∏–≤–æ—Ç–Ω—ã–µ\" –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Ç–æ–≥–æ, —á—Ç–æ –æ–Ω–∏ –µ–¥—è—Ç.",
        images: [
          "img/at-the-zoo-1.jpg",
          "img/at-the-zoo-2.jpg"
        ]
      },
      {
        title: "–ö–Ω–∏–≥–∞ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ Camouflage",
        category: "reading",
        short: "–ö–Ω–∏–≥–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è –æ –º–∞—Å–∫–∏—Ä–æ–≤–∫–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö. –¢–µ–∫—Å—Ç—ã, –∞—É–¥–∏–æ –∏ –∑–∞–¥–∞–Ω–∏—è. Present Simple.",
        full: "–ö–Ω–∏–≥–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è Camouflage –æ —Å–ø–æ—Å–æ–±–∞—Ö –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ –≤ –º–∏—Ä–µ –∂–∏–≤–æ—Ç–Ω—ã—Ö. –¢–µ–∫—Å—Ç—ã, –∞—É–¥–∏–æ –∏ –∑–∞–¥–∞–Ω–∏—è –∫ —É—á–µ–±–Ω–∏–∫—É —Å –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–æ–π. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø—Ä–æ—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–º \"–ñ–∏–≤–æ—Ç–Ω—ã–µ\", \"–ß–∞—Å—Ç–∏ —Ç–µ–ª–∞\". –¢–µ–∫—Å—Ç –Ω–∞–ø–∏—Å–∞–Ω –≤ Present Simple.",
        images: [
          "img/camouflage-1.jpg",
          "img/camouflage-2.jpg"
        ]
      },
      {
        title: "–ö–Ω–∏–≥–∞ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ Can you see lions",
        category: "reading",
        short: "Present Simple + Present Continuous. –õ–µ–∫—Å–∏–∫–∞: –∂–∏–≤–æ—Ç–Ω—ã–µ, –≥–ª–∞–≥–æ–ª—ã. –¢–µ–∫—Å—Ç, –∞—É–¥–∏–æ –∏ –∑–∞–¥–∞–Ω–∏—è.",
        full: "–ö–Ω–∏–≥–∞ Can you see lions? –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç –≤ Present Simple, Present Continuous, –ª–µ–∫—Å–∏–∫–∞ \"–ñ–∏–≤–æ—Ç–Ω—ã–µ\", –≥–ª–∞–≥–æ–ª—ã. –í —É—Ä–æ–∫–∞—Ö ‚Äî —Ç–µ–∫—Å—Ç, –∞—É–¥–∏–æ, –∑–∞–¥–∞–Ω–∏—è –¥–ª—è –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—è –ª–µ–∫—Å–∏–∫–∏ –∏ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏.",
        images: [
          "img/can-you-see-lions-1.jpg",
          "img/can-you-see-lions-2.jpg"
        ]
      },
      {
        title: "–ö–Ω–∏–≥–∞ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ Clunk draws a picture",
        category: "reading",
        short: "–¢–µ–º–∞: —Ü–≤–µ—Ç–∞. –°—Ç—Ä—É–∫—Ç—É—Ä—ã: It‚Äôs + color / It isn‚Äôt + color. –¢–µ–∫—Å—Ç, –∞—É–¥–∏–æ –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.",
        full: "–ö–Ω–∏–≥–∞ Clunk draws a picture. –û—Å–Ω–æ–≤–Ω–∞—è –ª–µ–∫—Å–∏—á–µ—Å–∫–∞—è —Ç–µ–º–∞ \"–¶–≤–µ—Ç–∞\", –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ It's + —Ü–≤–µ—Ç, It isn't + —Ü–≤–µ—Ç. –í —É—Ä–æ–∫–µ: —Ç–µ–∫—Å—Ç —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏, –∞—É–¥–∏–æ, —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.",
        images: [
          "img/clunk-draws-a-picture-1.jpg",
          "img/clunk-draws-a-picture-2.jpg"
        ]
      },
      {
        title: "–ö–Ω–∏–≥–∞ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ Clunk in Space",
        category: "reading",
        short: "–ö–Ω–∏–≥–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏–∑ —Å–µ—Ä–∏–∏ Read and Imagine. –¢–µ–∫—Å—Ç—ã, –∞—É–¥–∏–æ –∏ –∑–∞–¥–∞–Ω–∏—è. –¢–µ–º–∞: –∫–æ—Å–º–æ—Å.",
        full: "–ö–Ω–∏–≥–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è Clunk in Space –∏–∑ —Å–µ—Ä–∏–∏ Read and Imagine. –¢–µ–∫—Å—Ç—ã, –∞—É–¥–∏–æ –∏ –∑–∞–¥–∞–Ω–∏—è —Å –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–æ–π. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤–≤–µ–¥–µ–Ω–∏—è —Ç–µ–º—ã \"–ö–æ—Å–º–æ—Å\".",
        images: [
          "img/clunk-in-space-1.jpg",
          "img/clunk-in-space-2.jpg"
        ]
      },
      {
        title: "–ù–∞–±–æ—Ä —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π - Comparative and superlative form of adjectives",
        category: "grammar",
        short: "\"–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã—Ö\" –Ω–∞ –í–∑–Ω–∞–Ω–∏—è.",
        full: "\"–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã—Ö\" –Ω–∞ –í–∑–Ω–∞–Ω–∏—è.",
        images: [
          "img/comparative-superlative-1.jpg",
          "img/comparative-superlative-2.jpg"
        ]
      },
      {
        title: "Family and friends 1 Unit 1 (CB, WB, Extra practice, Grammar, FF Plus) –Ω–∞ –í–∑–Ω–∞–Ω–∏—è",
        category: "other",
        short: "–ü–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ Family and Friends 1 Unit 1 –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –í–∑–Ω–∞–Ω–∏—è.",
        full: "–ü–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ Family and Friends 1 Unit 1 –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ –í–∑–Ω–∞–Ω–∏—è.",
        images: [
          "img/ff1-unit1-1.jpg",
          "img/ff1-unit1-2.jpg"
        ]
      }
    ];

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // –†–ï–ù–î–ï–†
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const grid = document.getElementById("grid");
    const q = document.getElementById("q");

    let filtered = [...PRODUCTS];

    // ‚úÖ –¢–µ–∫—É—â–∏–π —Ñ–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    let activeCategory = "all";

    // ‚úÖ –ö–Ω–æ–ø–∫–∏-—Ñ–∏–ª—å—Ç—Ä—ã
    const chips = document.querySelectorAll(".chip[data-filter]");
    chips.forEach(btn => {
      btn.addEventListener("click", () => {
        activeCategory = btn.dataset.filter || "all";
        chips.forEach(b => b.classList.toggle("active", b === btn));
        applyFilters();
      });
    });

    function escapeHtml(str){
      return String(str ?? "").replace(/[&<>\"']/g, (m) => ({
        "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
      }[m]));
    }

    function render(list){
      grid.innerHTML = "";
      list.forEach((p, idx) => {
        const img = p.images?.[0] || "img/placeholder.jpg"; // ‚úÖ —Å–¥–µ–ª–∞–π placeholder.jpg –≤ –ø–∞–ø–∫–µ img

        const el = document.createElement("article");
        el.className = "card";
        el.innerHTML = `
          <button class="thumb" type="button" data-open="${idx}" aria-label="–û—Ç–∫—Ä—ã—Ç—å —Ç–æ–≤–∞—Ä">
            <img src="${img}" alt="${escapeHtml(p.title)}" loading="lazy"
                 onerror="this.onerror=null; this.src='img/placeholder.jpg'" />
                    </button>
          <div class="card-body">
            <h3 class="title">${escapeHtml(p.title)}</h3>
            <p class="desc">${escapeHtml(p.short)}</p>

            <div class="row">
              <div class="pill">–ú–∞—Ç–µ—Ä–∏–∞–ª</div>
              <div class="price">–¶–µ–Ω–∞: —É—Ç–æ—á–Ω–∏—Ç—å</div>
            </div>

            <div class="card-actions">
              <button class="btn primary" data-open="${idx}">–ö—É–ø–∏—Ç—å</button>
              <button class="btn" data-open="${idx}">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
            </div>
          </div>
        `;
        grid.appendChild(el);
      });
    }

    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    // MODAL + CAROUSEL
    // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const overlay = document.getElementById("overlay");
    const closeBtn = document.getElementById("close");
    const prevBtn = document.getElementById("prev");
    const nextBtn = document.getElementById("next");
    const bigImg = document.getElementById("bigImg");
    const dots = document.getElementById("dots");

    const mTitle = document.getElementById("mTitle");
    const mDesc = document.getElementById("mDesc");
    const mPrice = document.getElementById("mPrice");
    const buy = document.getElementById("buy");

    let current = null;
    let slide = 0;

    function openModal(product){
      current = product;
      slide = 0;

      mTitle.textContent = product.title;
      mDesc.textContent = product.full || product.short || "";
      mPrice.textContent = "–¶–µ–Ω–∞: —É—Ç–æ—á–Ω–∏—Ç—å";
      buy.href = VK_BUY_URL;

      buildDots(product.images || []);
      showSlide(0);

      overlay.style.display = "flex";
      overlay.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";
    }

    function closeModal(){
      overlay.style.display = "none";
      overlay.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
      current = null;
    }

    function showSlide(i){
      const imgs = current?.images || [];
      if(!imgs.length){
        bigImg.src = "img/placeholder.jpg";
        bigImg.alt = "";
        return;
      }

      slide = (i + imgs.length) % imgs.length;
      bigImg.src = imgs[slide];
      bigImg.alt = current?.title ? `${current.title} ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ${slide+1}` : "";
      bigImg.onerror = () => { bigImg.src = "img/placeholder.jpg"; };

      [...dots.children].forEach((d, idx) => d.classList.toggle("active", idx === slide));
    }

    function buildDots(imgs){
      dots.innerHTML = "";
      imgs.forEach((_, idx) => {
        const b = document.createElement("button");
        b.className = "dot" + (idx===0 ? " active" : "");
        b.type = "button";
        b.addEventListener("click", () => showSlide(idx));
        dots.appendChild(b);
      });

      const showNav = imgs.length > 1;
      prevBtn.style.display = showNav ? "grid" : "none";
      nextBtn.style.display = showNav ? "grid" : "none";
      dots.style.display = showNav ? "flex" : "none";
    }

    // events
    grid.addEventListener("click", (e) => {
      const t = e.target.closest("[data-open]");
      if(!t) return;
      const idx = Number(t.getAttribute("data-open"));
      const product = filtered[idx];
      if(product) openModal(product);
    });

    closeBtn.addEventListener("click", closeModal);
    overlay.addEventListener("click", (e) => { if(e.target === overlay) closeModal(); });

    document.addEventListener("keydown", (e) => {
      if(overlay.style.display !== "flex") return;
      if(e.key === "Escape") closeModal();
      if(e.key === "ArrowLeft") showSlide(slide - 1);
      if(e.key === "ArrowRight") showSlide(slide + 1);
    });

    prevBtn.addEventListener("click", () => showSlide(slide - 1));
    nextBtn.addEventListener("click", () => showSlide(slide + 1));

    // search
    function applySearch(val){
      // —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ–∏—Å–∫–∞
      const s = val.trim().toLowerCase();
      window.__search = s;
      applyFilters();
    }

    function applyFilters(){
      const s = (window.__search || "").trim().toLowerCase();

      // 1) —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
      let list = PRODUCTS;
      if(activeCategory !== "all"){
        list = list.filter(p => (p.category || "other") === activeCategory);
      }

      // 2) —Ñ–∏–ª—å—Ç—Ä –ø–æ –ø–æ–∏—Å–∫—É
      if(s){
        list = list.filter(p => (p.title + " " + (p.short||"") + " " + (p.full||"")).toLowerCase().includes(s));
      }

      filtered = list;
      render(filtered);
    }

    q.addEventListener("input", () => applySearch(q.value));

    // first render
    render(filtered);

    /* ==========================================================
       üé≤ GAMIFICATION: "–ú–Ω–µ –ø–æ–≤–µ–∑—ë—Ç!" (–ª–æ–∫ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞–≤—Å–µ–≥–¥–∞)
       ========================================================== */

    const LUCK_KEY = "pe_luck_coupon_v1";

    const luckBtn = document.getElementById("luckBtn");
    const luckOverlay = document.getElementById("luckOverlay");
    const luckClose = document.getElementById("luckClose");
    const luckBoard = document.getElementById("luckBoard");
    const luckPlay = document.getElementById("luckPlay");
    const luckDownload = document.getElementById("luckDownload");
    const luckStatus = document.getElementById("luckStatus");
    const luckSub = document.getElementById("luckSub");

    const rulesBtn = document.getElementById("rulesBtn");
    const rulesOverlay = document.getElementById("rulesOverlay");
    const rulesClose = document.getElementById("rulesClose");

    const PRIZES = [
      {
        id: "p1",
        title: "–°–∫–∏–¥–∫–∞ 10% –Ω–∞ –ª—é–±–æ–π —Ç–æ–≤–∞—Ä",
        meta: "–ö—É–ø–æ–Ω –Ω–∞ —Å–∫–∏–¥–∫—É",
        weight: 1
      },
      {
        id: "p2",
        title: "–¢—Ä–µ—Ç–∏–π —Ç–æ–≤–∞—Ä –±–µ—Å–ø–ª–∞—Ç–Ω–æ*",
        meta: "–ü–æ–¥–∞—Ä–æ–∫ –≤ –∫–æ—Ä–∑–∏–Ω–µ",
        weight: 1
      },
      {
        id: "p3",
        title: "–°–∫–∏–¥–∫–∞ 20% –Ω–∞ –ª—é–±–æ–π —Ç–æ–≤–∞—Ä",
        meta: "–†–µ–¥–∫–∏–π –ø—Ä–∏–∑",
        weight: 0.35 // –∑–∞–º–µ—Ç–Ω–æ –Ω–∏–∂–µ, –Ω–æ –Ω–µ ¬´–º–∏–∫—Ä–æ¬ª
      },
      {
        id: "p4",
        title: "–°—É–ø–µ—Ä –ø—Ä–∏–∑! –°–∫–∏–¥–∫–∞ 15% –Ω–∞ –≤—Å—é –∫–æ—Ä–∑–∏–Ω—É",
        meta: "–ù–∞ –≤–µ—Å—å –∑–∞–∫–∞–∑",
        weight: 1
      },
      {
        id: "p5",
        title: "–ö–Ω–∏–≥–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è –≤ –ø–æ–¥–∞—Ä–æ–∫**",
        meta: "–ò–∑ —Ä–∞–∑–¥–µ–ª–∞ ¬´–ß—Ç–µ–Ω–∏–µ¬ª",
        weight: 1
      },
      {
        id: "p6",
        title: "–£—Ä–æ–∫ –ø–æ –≥—Ä–∞–º–º–∞—Ç–∏–∫–µ –≤ –ø–æ–¥–∞—Ä–æ–∫***",
        meta: "–ò–∑ —Ä–∞–∑–¥–µ–ª–∞ ¬´–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞¬ª",
        weight: 1
      },
    ];

    function loadLuck(){
      try{
        const raw = localStorage.getItem(LUCK_KEY);
        return raw ? JSON.parse(raw) : null;
      }catch{ return null; }
    }

    function saveLuck(data){
      try{ localStorage.setItem(LUCK_KEY, JSON.stringify(data)); }catch{}
    }

    function randCode(){
      const alphabet = "ABCDEFGHJKMNPQRSTUVWXYZ23456789"; // –±–µ–∑ –ø–æ—Ö–æ–∂–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
      let s = "PE-";
      for(let i=0;i<6;i++) s += alphabet[Math.floor(Math.random()*alphabet.length)];
      return s;
    }

    function weightedPick(items){
      const total = items.reduce((a,x)=>a+(x.weight||1),0);
      let r = Math.random() * total;
      for(const it of items){
        r -= (it.weight||1);
        if(r <= 0) return it;
      }
      return items[items.length-1];
    }

    function fmtDate(ts){
      const d = new Date(ts);
      const dd = String(d.getDate()).padStart(2,"0");
      const mm = String(d.getMonth()+1).padStart(2,"0");
      const yy = d.getFullYear();
      return `${dd}.${mm}.${yy}`;
    }

    let luckState = "idle"; // idle | shuffling | pick | done
    let shuffleTimer = null;

    function openLuck(){
      luckOverlay.style.display = "flex";
      luckOverlay.setAttribute("aria-hidden","false");
      document.body.style.overflow = "hidden";
      hydrateLuckUI();
    }

    function closeLuck(){
      luckOverlay.style.display = "none";
      luckOverlay.setAttribute("aria-hidden","true");
      document.body.style.overflow = "";
      stopShuffle();
    }

    function openRules(){
      rulesOverlay.style.display = "flex";
      rulesOverlay.setAttribute("aria-hidden","false");
    }
    function closeRules(){
      rulesOverlay.style.display = "none";
      rulesOverlay.setAttribute("aria-hidden","true");
    }

    function stopShuffle(){
      if(shuffleTimer){ clearInterval(shuffleTimer); shuffleTimer = null; }
      Array.from(luckBoard.children).forEach(el => el.classList.remove("shuffling"));
    }

    function renderPrizeCards(){
      luckBoard.innerHTML = "";
      PRIZES.forEach((p, idx) => {
        const card = document.createElement("div");
        card.className = "pcard";
        card.setAttribute("role","button");
        card.setAttribute("tabindex","0");
        card.setAttribute("data-idx", String(idx));
        card.setAttribute("aria-label", p.title);

        card.innerHTML = `
          <div class="pinner" data-inner>
            <div class="pface pfront">
              <div class="ptitle">${escapeHtml(p.title)}</div>
              <div class="pmeta">${escapeHtml(p.meta || "")}</div>
            </div>
            <div class="pface pback">
              <div class="pseal"><span class="dot"></span> –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É <span class="dot"></span></div>
            </div>
          </div>
        `;
        luckBoard.appendChild(card);
      });
    }

    function setAllFaceDown(){
      Array.from(luckBoard.querySelectorAll("[data-inner]")).forEach(el => {
        el.classList.add("face-down");
        el.classList.remove("revealed");
      });
    }

    function revealCard(domCard, prize){
      const inner = domCard.querySelector("[data-inner]");
      const frontTitle = domCard.querySelector(".pfront .ptitle");
      const frontMeta = domCard.querySelector(".pfront .pmeta");
      frontTitle.textContent = prize.title;
      frontMeta.textContent = "–í–∞—à –ø—Ä–∏–∑ üéâ";
      inner.classList.remove("face-down");
      inner.classList.add("revealed");
    }

    function setBoardDisabled(disabled){
      Array.from(luckBoard.children).forEach(el => {
        el.setAttribute("aria-disabled", disabled ? "true" : "false");
      });
    }

    function hydrateLuckUI(){
      const saved = loadLuck();
      renderPrizeCards();

      luckDownload.style.display = "none";
      luckPlay.style.display = "inline-block";
      luckPlay.disabled = false;
      luckState = "idle";
      luckStatus.textContent = "";
      luckSub.textContent = "–ù–∞–∂–º–∏ ¬´–ò–≥—Ä–∞—Ç—å¬ª, –∑–∞—Ç–µ–º –≤—ã–±–µ—Ä–∏ –æ–¥–Ω—É –∫–∞—Ä—Ç–æ—á–∫—É –∏ –ø–æ–ª—É—á–∏ –ø—Ä–∏–∑–æ–≤–æ–π –∫—É–ø–æ–Ω.";

      // –µ—Å–ª–∏ —É–∂–µ –ø–æ–ª—É—á–∞–ª–∏ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –¥–∞—ë–º —Å–∫–∞—á–∞—Ç—å —Å–Ω–æ–≤–∞
      if(saved && saved.claimed){
        luckState = "done";
        luckPlay.style.display = "inline-block";
        luckPlay.textContent = "–°—ã–≥—Ä–∞–Ω–æ";
        luckPlay.disabled = true;
        luckDownload.style.display = "inline-block";
        luckStatus.textContent = `–ö—É–ø–æ–Ω —É–∂–µ –ø–æ–ª—É—á–µ–Ω: ${saved.code} (${fmtDate(saved.ts)})`;
        luckSub.textContent = "–í—ã —É–∂–µ –ø–æ–ª—É—á–∏–ª–∏ –∫—É–ø–æ–Ω –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ. –ú–æ–∂–µ—Ç–µ —Å–∫–∞—á–∞—Ç—å –µ–≥–æ –µ—â—ë —Ä–∞–∑.";
        setAllFaceDown();
        setBoardDisabled(true);

        // –ø–æ–∫–∞–∂–µ–º –æ–¥–Ω—É ¬´–ø–æ–±–µ–¥–∏–≤—à—É—é¬ª –∫–∞—Ä—Ç–æ—á–∫—É –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã
        const prize = PRIZES.find(p => p.id === saved.prizeId) || PRIZES[0];
        const pick = luckBoard.children[Math.min(2, luckBoard.children.length-1)];
        if(pick) revealCard(pick, prize);

        luckDownload.onclick = () => downloadCoupon(prize, saved.code, saved.ts);
      }else{
        // –µ—â—ë –Ω–µ –∏–≥—Ä–∞–ª–∏
        luckPlay.textContent = "–ò–≥—Ä–∞—Ç—å";
        setBoardDisabled(true);
      }
    }

    function startGame(){
      // –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–æ–≤
      const saved = loadLuck();
      if(saved && saved.claimed){
        hydrateLuckUI();
        return;
      }

      luckState = "shuffling";
      luckDownload.style.display = "none";
      luckStatus.textContent = "–ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º‚Ä¶";
      setBoardDisabled(true);

      // –ø–µ—Ä–µ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º (–≤—Å–µ —Ä—É–±–∞—à–∫–æ–π –≤–≤–µ—Ä—Ö)
      setAllFaceDown();

      // –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ: –±—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∞ DOM + –Ω–µ–±–æ–ª—å—à–∞—è –¥—Ä–æ–∂—å
      const cards = Array.from(luckBoard.children);
      cards.forEach(c => c.classList.add("shuffling"));
      shuffleTimer = setInterval(() => {
        const arr = Array.from(luckBoard.children);
        // —Ç–∞—Å—É–µ–º DOM-—É–∑–ª—ã
        for(let i = arr.length - 1; i > 0; i--){
          const j = Math.floor(Math.random() * (i + 1));
          luckBoard.insertBefore(arr[j], arr[i]);
          // –æ–±–Ω–æ–≤–∏–º –º–∞—Å—Å–∏–≤ –ª–æ–∫–∞–ª—å–Ω–æ
          const tmp = arr[i];
          arr[i] = arr[j];
          arr[j] = tmp;
        }
      }, 120);

      setTimeout(() => {
        stopShuffle();
        luckState = "pick";
        luckStatus.textContent = "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É üëá";
        setBoardDisabled(false);
      }, 1400);
    }

    function onPick(domCard){
      const saved = loadLuck();
      if(saved && saved.claimed){
        // —É–∂–µ —Å—ã–≥—Ä–∞–Ω–æ
        return;
      }
      if(luckState !== "pick") return;
      if(domCard.getAttribute("aria-disabled") === "true") return;

      luckState = "done";
      setBoardDisabled(true);

      const prize = weightedPick(PRIZES);
      const code = randCode();
      const ts = Date.now();

      revealCard(domCard, prize);
      luckStatus.textContent = `–í–∞—à –∫—É–ø–æ–Ω: ${code}`;
      luckSub.textContent = "–ì–æ—Ç–æ–≤–æ! –°–∫–∞—á–∞–π—Ç–µ –∫—É–ø–æ–Ω –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –æ–¥–∏–Ω —Ä–∞–∑.";
      luckDownload.style.display = "inline-block";

      saveLuck({ claimed: true, prizeId: prize.id, code, ts });
      luckPlay.textContent = "–°—ã–≥—Ä–∞–Ω–æ";
      luckPlay.disabled = true;

      luckDownload.onclick = () => downloadCoupon(prize, code, ts);

      // –æ–±–Ω–æ–≤–∏–º –∫–Ω–æ–ø–∫—É –≤ —Ö–∏—Ä–æ
      syncLuckButton();
    }

    function downloadCoupon(prize, code, ts){
      const canvas = document.createElement("canvas");
      const dpr = Math.max(1, Math.min(2.5, window.devicePixelRatio || 1));
      const W = 1080, H = 720;
      canvas.width = Math.round(W * dpr);
      canvas.height = Math.round(H * dpr);
      canvas.style.width = W + "px";
      canvas.style.height = H + "px";
      const ctx = canvas.getContext("2d");
      ctx.scale(dpr, dpr);

      // helpers
      function rrect(x,y,w,h,r){
        const rr = Math.min(r, w/2, h/2);
        ctx.beginPath();
        ctx.moveTo(x+rr, y);
        ctx.arcTo(x+w, y, x+w, y+h, rr);
        ctx.arcTo(x+w, y+h, x, y+h, rr);
        ctx.arcTo(x, y+h, x, y, rr);
        ctx.arcTo(x, y, x+w, y, rr);
        ctx.closePath();
      }

      // background
      const bg = ctx.createLinearGradient(0,0,0,H);
      bg.addColorStop(0, "#ffffff");
      bg.addColorStop(1, "#f4f7ff");
      ctx.fillStyle = bg;
      ctx.fillRect(0,0,W,H);

      // soft blobs
      function blob(x,y,rx,ry,rgba){
        const g = ctx.createRadialGradient(x,y,0,x,y,Math.max(rx,ry));
        g.addColorStop(0, rgba);
        g.addColorStop(1, "rgba(255,255,255,0)");
        ctx.fillStyle = g;
        ctx.beginPath();
        ctx.ellipse(x,y,rx,ry,0,0,Math.PI*2);
        ctx.fill();
      }
      blob(220, 150, 260, 180, "rgba(37,99,235,.18)");
      blob(900, 120, 280, 190, "rgba(239,68,68,.16)");
      blob(620, 660, 320, 210, "rgba(16,185,129,.16)");

      // main card
      const pad = 64;
      const x = pad, y = pad;
      const w = W - pad*2, h = H - pad*2;
      ctx.save();
      ctx.shadowColor = "rgba(15,23,42,.18)";
      ctx.shadowBlur = 28;
      ctx.shadowOffsetY = 10;
      ctx.fillStyle = "rgba(255,255,255,.92)";
      rrect(x,y,w,h,28);
      ctx.fill();
      ctx.restore();

      // border
      ctx.strokeStyle = "rgba(15,23,42,.12)";
      ctx.lineWidth = 2;
      rrect(x,y,w,h,28);
      ctx.stroke();

      // top accent line
      const grad = ctx.createLinearGradient(x, y, x+w, y);
      grad.addColorStop(0, "rgba(37,99,235,.9)");
      grad.addColorStop(.33, "rgba(239,68,68,.85)");
      grad.addColorStop(.66, "rgba(16,185,129,.85)");
      grad.addColorStop(1, "rgba(245,158,11,.9)");
      ctx.fillStyle = grad;
      rrect(x+18, y+18, w-36, 10, 8);
      ctx.fill();

      // header
      ctx.fillStyle = "rgba(15,23,42,.92)";
      ctx.font = "800 34px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText("Power English", x+36, y+86);

      ctx.fillStyle = "rgba(37,99,235,.95)";
      ctx.font = "800 22px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText("–ü—Ä–∏–∑–æ–≤–æ–π –∫—É–ø–æ–Ω", x+36, y+120);

      // prize
      ctx.fillStyle = "rgba(15,23,42,.92)";
      ctx.font = "900 38px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      wrapText(ctx, prize.title, x+36, y+190, w-72, 44);

      // code block
      const bx = x+36, by = y+360, bw = w-72, bh = 120;
      ctx.fillStyle = "rgba(37,99,235,.08)";
      rrect(bx, by, bw, bh, 22);
      ctx.fill();
      ctx.strokeStyle = "rgba(37,99,235,.22)";
      ctx.lineWidth = 2;
      rrect(bx, by, bw, bh, 22);
      ctx.stroke();

      ctx.fillStyle = "rgba(15,23,42,.75)";
      ctx.font = "700 16px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText("–ö–æ–¥ –∫—É–ø–æ–Ω–∞", bx+22, by+34);

      ctx.fillStyle = "rgba(15,23,42,.92)";
      ctx.font = "900 48px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText(code, bx+22, by+90);

      // date + hint
      ctx.fillStyle = "rgba(71,85,105,.95)";
      ctx.font = "700 16px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText("–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏: " + fmtDate(ts), x+36, y+h-78);
      ctx.fillStyle = "rgba(71,85,105,.9)";
      ctx.font = "600 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial";
      ctx.fillText("–ü–æ–∫–∞–∂–∏—Ç–µ –∫–æ–¥ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ (VK). –ö—É–ø–æ–Ω –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑.", x+36, y+h-48);

      // download
      const a = document.createElement("a");
      a.download = `coupon-${code}.png`;
      a.href = canvas.toDataURL("image/png");
      a.click();
    }

    function wrapText(ctx, text, x, y, maxWidth, lineHeight){
      const words = String(text).split(/\s+/);
      let line = "";
      let yy = y;
      for(let n=0; n<words.length; n++){
        const testLine = line ? (line + " " + words[n]) : words[n];
        const m = ctx.measureText(testLine);
        if(m.width > maxWidth && n > 0){
          ctx.fillText(line, x, yy);
          line = words[n];
          yy += lineHeight;
        }else{
          line = testLine;
        }
      }
      if(line) ctx.fillText(line, x, yy);
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function syncLuckButton(){
      const saved = loadLuck();
      if(!luckBtn) return;
      if(saved && saved.claimed){
        luckBtn.innerHTML = `<span class="luck-spark">‚úÖ</span> –ö—É–ø–æ–Ω –ø–æ–ª—É—á–µ–Ω`;
      }else{
        luckBtn.innerHTML = `<span class="luck-spark">üé≤</span> –ú–Ω–µ –ø–æ–≤–µ–∑—ë—Ç!`;
      }
    }

    // wiring
    if(luckBtn){
      luckBtn.addEventListener("click", openLuck);
      syncLuckButton();
    }

    luckClose.addEventListener("click", closeLuck);
    luckOverlay.addEventListener("click", (e) => { if(e.target === luckOverlay) closeLuck(); });

    document.addEventListener("keydown", (e) => {
      if(luckOverlay.style.display !== "flex") return;
      if(e.key === "Escape") closeLuck();
    });

    rulesBtn.addEventListener("click", openRules);
    rulesClose.addEventListener("click", closeRules);
    rulesOverlay.addEventListener("click", (e) => { if(e.target === rulesOverlay) closeRules(); });

    luckPlay.addEventListener("click", startGame);

    // click / keyboard pick
    luckBoard.addEventListener("click", (e) => {
      const card = e.target.closest(".pcard");
      if(!card) return;
      onPick(card);
    });
    luckBoard.addEventListener("keydown", (e) => {
      if(e.key !== "Enter" && e.key !== " ") return;
      const card = e.target.closest(".pcard");
      if(!card) return;
      e.preventDefault();
      onPick(card);
    });
  </script>
</body>
</html>
